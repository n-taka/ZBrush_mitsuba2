[VarDef, currentTool]
[VarDef, XYZSize]
[VarDef, useGizmo]
[VarDef, sXpos, 0]
[VarDef, sYpos, 0]
[VarDef, sZpos, 0]
[VarDef, eXpos, 0]
[VarDef, eYpos, 0]
[VarDef, eZpos, 0]
[VarDef, viewUpX, 0]
[VarDef, viewUpY, 0]
[VarDef, viewUpZ, 0]
[VarDef, viewRightX, 0]
[VarDef, viewRightY, 0]
[VarDef, viewRightZ, 0]
[VarDef, viewDirX, 0]
[VarDef, viewDirY, 0]
[VarDef, viewDirZ, 0]

[IButton, "DebugBtn", "debug", 
    [IFreeze,
        ////
        // store index of current tool
        [VarSet, currentTool, [IGet,Tool:ItemInfo]]
        // store current export setting
        // todo
        // disable eFlip(X|Y|Z)
        // todo
        // export to GoZ file
        // todo

        ////
        // set to PolyMesh 3D (for making sure that we successfully draw Transpose Action Line)
        // We draw Action Line from mesh to out of canvas
        // https://www.zbrushcentral.com/t/transformset-gimbal-lock-workaround/310971/8
        [ISet,Tool:ItemInfo,41]
        [IPress,Transform:Fit]
        // store current parameters
        [VarSet,XYZSize,[IGet,Tool:Geometry:XYZ Size]]
        [VarSet,useGizmo,[IGet, Transform:Gizmo 3D]]
        // get directions
        [ISet,Tool:Geometry:XYZ Size,20]
        [IPress,Transform:Move]
        [IUnPress,Transform:Gizmo 3D]
        [IClick,1004,(Document:Width*.5)+100, (Document:Height*.5),(Document:Width*.5)+100,-100]
        [TransposeGet, sXpos, sYpos, sZpos, eXpos, eYpos, eZpos]
        [VarSet, viewUpX, (#eXpos - #sXpos)]
        [VarSet, viewUpY, (#eYpos - #sYpos)]
        [VarSet, viewUpZ, (#eZpos - #sZpos)]
        [IClick,1004,(Document:Width*.5),(Document:Height*.5),(Document:Width)+100,(Document:Height*.5)]
        [TransposeGet, sXpos, sYpos, sZpos, eXpos, eYpos, eZpos]
        [VarSet, viewRightX, (#eXpos - #sXpos)]
        [VarSet, viewRightY, (#eYpos - #sYpos)]
        [VarSet, viewRightZ, (#eZpos - #sZpos)]
        [VarSet, viewDirX, ((#viewUpY * #viewRightZ)-(#viewUpZ * #viewRightY))]
        [VarSet, viewDirY, ((#viewUpZ * #viewRightX)-(#viewUpX * #viewRightZ))]
        [VarSet, viewDirZ, ((#viewUpX * #viewRightY)-(#viewUpY * #viewRightX))]
        // restore parameters
        [ISet,Tool:Geometry:XYZ Size,#XYZSize]
        [If, useGizmo, [IPress,Transform:Gizmo 3D], [IUnPress,Transform:Gizmo 3D]]
        // restore currentTool
        [ISet,Tool:ItemInfo,#currentTool]
        [IPress,Transform:Fit]

        ////
        // generate JSON string
        // todo

        ////
        // call dll function
        // todo
    ]

    // debug
    [Note, [StrMerge, #viewUpX, ", ", #viewUpY, ", ", #viewUpZ]]
    [Note, [StrMerge, #viewRightX, ", ", #viewRightY, ", ", #viewRightZ]]
    [Note, [StrMerge, #viewDirX, ", ", #viewDirY, ", ", #viewDirZ]]
]
